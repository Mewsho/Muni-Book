<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <!-- Importar Google fonst -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="icon" href="/Assets/Icon/book-svgrepo-com.svg" />

    <title>MuniBook</title>

    <script>
      let listaDocumentosAgregados = [];
      let listaCantEjemplaresAgregados = [];
      let idSolicitudGeneral
      let isPenalizado = false
      const objectPrestamos = {
        MapPrestamos: new Map(),
      };

      Object.defineProperty(objectPrestamos, "setter", {
        set: function (input) {
          let idDocumento = input[0];
          let Prestamo = input[1];

          if (this.MapPrestamos.has(idDocumento)) {
            let list = this.MapPrestamos.get(idDocumento);
            list.push(Prestamo);
            this.MapPrestamos.set(idDocumento, list);
          } else {
            this.MapPrestamos.set(idDocumento, [Prestamo]);
          }
          console.log("Inside object",this.MapPrestamos);
          let mapP = this.MapPrestamos;
          updSolicitudPrestamo(mapP);
        },
      });

      let usuarioIdGeneral = "";
      // Obtencion de cookies y cambios asociados
      async function aplicarVersionUsuario() {}

      async function ModalGenCheckBox() {
        let buttonContainer = document.getElementById("ModalCheckboxCategoria");
        let strButtons = `
        <li>
        <label class="dropdown-item">
          <input type="checkbox" value="option1"> Opción 1
        </label>
        </li>
      <li>
        <label class="dropdown-item">
          <input type="checkbox" value="option2"> Opción 2
        </label>
      </li>
      <li>
        <label class="dropdown-item">
          <input type="checkbox" value="option3"> Opción 3
        </label>
      </li>
      <li>
        <label class="dropdown-item">
          <input type="checkbox" value="option4"> Opción 4
        </label>
      </li>
        `;
        buttonContainer.innerHTML = strButtons;
      }

      async function aplicarVersionBibliotecario() {
        let buttonContainer = document.getElementById("contaniner-bb-buttons");
        let strButtons = `
        <div class="d-grid gap-2 d-md-flex justify-content-md-center my-4 mx-3">
          <button type="button" class="btn btn-dark btn-rounded cat-button" data-bs-toggle="modal"
          data-bs-target="#Agregardoc">Agregar Documento</button>

          <button type="button" class="btn btn-secondary cat-button" data-bs-toggle="modal"
          data-bs-target="#ModalEliminarDocumento">Eliminar Documento</button>   
          <button type="button" class="btn btn-dark cat-button" data-bs-toggle="modal"
          data-bs-target="#ModalAgregarEjemplares">Agregar Ejemplar</button>
          <button type="button" class="btn btn-secondary cat-button" data-bs-toggle="modal"

          data-bs-target="#DelEjemplares">Eliminar Ejemplar</button>
        </div>
        `;
        buttonContainer.innerHTML = strButtons;
      }

      function AddDocumento() {
        let ModalAnioSalida = document.getElementById("ModalAnioSalida").value;
        let ModalAutor = document.getElementById("ModalAutor").value;
        let ModalCategoriaDocumento =
          document.getElementById("TipCategoriaModal");
        let CategoriasHijos = [];
        for (child of ModalCategoriaDocumento.children) {
          for (child2 of child.children) {
            if (child2.checked) {
              CategoriasHijos.push(child2.value);
            }
          }
        }

        let ModalCodigo = document.getElementById("ModalCodigo").value;
        let ModalEdicion = document.getElementById("ModalEdicion").value;
        let ModalEditorial = document.getElementById("ModalEditorial").value;
        //let ModalTipoDocumento = document.getElementById("ModalTipoDocumento").value;
        let ModalTitulo = document.getElementById("ModalTitulo").value;
        let Modal = document.getElementById("Agregardoc");
        let tipo = document.getElementById("ModalformSelectTipo").value;
        console.log(tipo);

        let queryAddDocumento = `
          mutation AddDocumento($input: DocumentoInput) {
          addDocumento(input: $input) {
          body
          descriptionError
          errorCode
          statusCode
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryAddDocumento,
            variables: {
              input: {
                anioSalida: parseInt(ModalAnioSalida, 10),
                autor: ModalAutor,
                categoriaDocumento: CategoriasHijos,
                codigo: ModalCodigo,
                edicion: parseInt(ModalEdicion, 10),
                editorial: ModalEditorial,
                tipoDocumento: tipo,
                titulo: ModalTitulo,
              },
            },
          }),
          success: function (response) {
            let mensajeDiv = document.getElementById("mensajeAddDocumento");
            mensajeDiv.style.display = 'block'
            mensajeDiv.innerHTML =
                '<div class="alert alert-success">Documento Agregado con éxito.</div>';
            
            setTimeout(function () {
              mensajeDiv.style.display = "none"; 
            }, 2000);
          },
          error: function (error) {
            let mensajeDiv = document.getElementById("mensajeAddDocumento");
            mensajeDiv.style.display = 'block'
            mensajeDiv.innerHTML =
                '<div class="alert alert-danger">No ha sido posible agregar el documento, rellene los campos faltantes.</div>';
            
            setTimeout(function () {
              mensajeDiv.style.display = "none"; 
            }, 2000);
          },
        });
      }

      function aplicarVersionUsuario(){
        let elemento = document.getElementById("carritoCompras");
        elemento.classList.remove("d-none");
      }

      function aplicarVersionBibliotecario() {
          let elemento = document.getElementById("navbarBibliotecario");
          elemento.classList.remove("d-none");
      }

      function aplicarVersionNotUsuario() {
        let elemento = document.getElementById("carritoCompras");
        elemento.classList.remove("d-none");
      }

      function aplicarVersionAdministrador() {
          let elemento1 = document.getElementById("NavbarAdmin");
          elemento1.classList.remove("d-none");
      }

      function checkCookieExistence(name) {
        console.log(document.cookie);
        if (
          document.cookie
            .split(";")
            .some((item) => item.trim().startsWith(`${name}=`))
        ) {
          let tipoCookie = document.cookie
            .split("; ")
            .find((row) => row.startsWith(`${name}=`))
            ?.split("=")[1];
          let UsuarioIdCookie = document.cookie
            .split("; ")
            .find((row) => row.startsWith(`id=`))
            ?.split("=")[1];

          usuarioIdGeneral = UsuarioIdCookie;

          tipoCookie = parseInt(tipoCookie, 10);

          switch (tipoCookie) {
            case 0:
              console.log("Usuario");
              aplicarVersionUsuario();
              break;
            case 1:
              console.log("Bibliotecario");
              aplicarVersionBibliotecario();
              break;
            case 2:
              console.log("Administrador");
              aplicarVersionAdministrador();

              break;
            /*  
            default:
              aplicarVersionNotUsuario()
              console.log(tipoCookie)
              console.log("NotUsuario")
              */
          }
        } else {
          console.log("NotUsuario");
          aplicarVersionNotUsuario();
        }
      }

      // form select de tipo y categoria
      let tiposDocumentos = []
      let optionFormSelectTipo = ['<option value="">Selecciona Tipo</option>'];
      function optionTipo(item) {
        optionFormSelectTipo.push(
          '<option value="' + item.id + '">' + item.tipo + "</option>"
        );
        tiposDocumentos.push(item.tipo)
      }

      let optionModalTipoCategoria = [];
      function optionModalCategoria(item) {
        optionModalTipoCategoria.push(
          `<label class="dropdown-item">
                        <input type="checkbox" value="${item.id}" class="me-2"/>
                        ${item.categoria}
                      </label>`
        );
      }

      let optionFormSelectCategoria = [
        '<option value="">Selecciona Categoria</option>',
      ];
      function optionCategoria(item) {
        optionFormSelectCategoria.push(
          '<option value="' + item.id + '">' + item.categoria + "</option>"
        );
      }

      let optionFormSelectDocumento = [
        '<option value="">Selecciona...</option>',
      ];
      function optionDocumentos(item) {
        optionFormSelectDocumento.push(
          `<option value="${item.id}" tipo="${item.tipoDocumento.tipo}">${item.titulo}</option>`
        );
      }
      // Funciones para optener la lista de tipo y categoria
      async function cargarTipo() {
        let queryTipo = `
        query GetTipoDocumentos {
          getTipoDocumentos {
            id
            tipo
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryTipo,
          }),
          success: function (response) {
            response.data.getTipoDocumentos.forEach(optionTipo);
            document.getElementById("formSelectTipo").innerHTML =
              optionFormSelectTipo.join("");

            document.getElementById("ModalformSelectTipo").innerHTML =
              optionFormSelectTipo.join("");
          },
        });
      }

      async function cargarCategoria() {
        let queryCategoria = `
        query GetCategoriaDocumentos {
          getCategoriaDocumentos {
            id
            categoria
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryCategoria,
          }),
          success: function (response) {
            response.data.getCategoriaDocumentos.forEach(optionCategoria);
            document.getElementById("formSelectCategoria").innerHTML =
              optionFormSelectCategoria.join("");
            response.data.getCategoriaDocumentos.forEach(optionModalCategoria);
            document.getElementById("TipCategoriaModal").innerHTML =
              optionModalTipoCategoria.join("");
          },
        });
      }


      function aplicarCambiosCard() {     
        let tipoUsuario = document.cookie
        .split("; ")
        .find((row) => row.startsWith(`tipo=`))
        ?.split("=")[1];
        if (tipoUsuario == 2) {
          let inputGroupList = document.getElementsByClassName("input-group");
          for (inputGroup of inputGroupList) {
            inputGroup.classList.add("d-none");
          }
        } else if (tipoUsuario == 1) {
        } else if (tipoUsuario == 0) {
          let collapseList = document.getElementsByClassName("buttonAndCant");
          for (collapse of collapseList) {
            let idDocumentoCollapse = collapse.id;
            let idDocumento = idDocumentoCollapse.split("-")[0];
            let strButton = `<button type="button" class="btn btn-secondary mx-2 alignVertical" 
            id="${idDocumento}-addButton">
            Agregar</button>
            `;
            collapse.insertAdjacentHTML("beforeend", strButton);

            $(`#${idDocumento}-addButton`).click(function () {
              addPrestamoToSolicitud(idDocumento);
            });
          }
        }    
      }

      function addDays(date, days) {
        var result = new Date(date);
        result.setDate(result.getDate() + days);
        return result;
      }

      async function addPrestamoToSolicitud(idDocumentoDelBoton) {
        let inputNumberDocumento = document.getElementById(
          `${idDocumentoDelBoton}-input`
        );
        let cantEjemplares = parseInt(inputNumberDocumento.value, 10);
        if (cantEjemplares == 0) {
          let prestamosAnteriores =
            objectPrestamos.MapPrestamos.get(idDocumentoDelBoton);
          prestamosAnteriores.forEach((prestamo) => eliminarPrestamo(prestamo));
          objectPrestamos.MapPrestamos.set(idDocumentoDelBoton, []);
          updSolicitudPrestamo(objectPrestamos.MapPrestamos)
          return;
        }
        if (objectPrestamos.MapPrestamos.has(idDocumentoDelBoton)) {
          let prestamosAnteriores =
            objectPrestamos.MapPrestamos.get(idDocumentoDelBoton);
          prestamosAnteriores.forEach((prestamo) => eliminarPrestamo(prestamo));
          objectPrestamos.MapPrestamos.set(idDocumentoDelBoton, []);
        }
        let arrayEjemplares = await getNEjemplaresByDocumentId(
          idDocumentoDelBoton,
          cantEjemplares
        );
      }

      function eliminarPrestamo(prestamo) {
        let idPrestamo = prestamo.id;
        let queryDelPrestamo = `
        mutation DelPrestamo($delPrestamoId: ID!) {
          delPrestamo(id: $delPrestamoId) {
            statusCode
            body
            errorCode
            descriptionError
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryDelPrestamo,
            variables: {
              delPrestamoId: idPrestamo,
            },
          }),
          success: function (response) {
            console.log("Prestamo eliminado");
          },
        });
      }

      function addPrestamo(ejemplarParametro, idDocumento) {
        let idEjemplar = ejemplarParametro.id;
        let queryAddPrestamo = `
        mutation AddPrestamo($input: PrestamoInput) {
          addPrestamo(input: $input) {
            id
            tipoPrestamo
            fechaPrestamo
            fechaDevolucion
            fechaDevolucionReal
          }
        }
        `;
        // Por default el prestamo sera en sala y la fecha es la actual
        let fechaActual = Date.now();
        let fechaDevolucion = addDays(fechaActual, 7).toISOString();
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryAddPrestamo,
            variables: {
              input: {
                tipoPrestamo: "Sala",
                ejemplar: idEjemplar,
                fechaPrestamo: fechaActual,
                fechaDevolucion: fechaDevolucion,
                fechaDevolucionReal: null,
              },
            },
          }),
          success: function (response) {
            let prestamo = response.data.addPrestamo;
            console.log(idDocumento, prestamo);
            objectPrestamos.setter = [idDocumento, prestamo];
          },
        });
      }

      function getNEjemplaresByDocumentId(idDocumento, cantEjemplares) {
        let queryEjemplares = `
        query GetNEjemplaresDisponiblesByDocumentId($documentoId: ID, $cantEjemplares: Int) {
          getNEjemplaresDisponiblesByDocumentId(documentoId: $documentoId, cantEjemplares: $cantEjemplares) {
            id
            codigo
            estado
            estadoTexto
            ubicacion
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryEjemplares,
            variables: {
              documentoId: idDocumento,
              cantEjemplares: cantEjemplares,
            },
          }),
          success: function (response) {
            let Ejemplares =
              response.data.getNEjemplaresDisponiblesByDocumentId;
            Ejemplares.forEach((item) => addPrestamo(item, idDocumento));
            console.log(Ejemplares);
          },
        });
      }

      async function crearSolicitudInicial() {
        let usuarioId = usuarioIdGeneral;
        let listaPrestamos = [];
        
        let queryAddSolicitudPrestamo = `
        mutation AddSolicitudPrestamo($addSolicitudPrestamoInput2: SolicitudPrestamoInput) {
          addSolicitudPrestamo(input: $addSolicitudPrestamoInput2) {
            id
            tipoSolicitud
            estadoSolicitud
            fechaSolicitud
          }
        }
        `;
        
        // Los defaults de la Solicitud
        let fechaActual = Date.now();
        let tipo = "Sala";
        let estado = 0;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryAddSolicitudPrestamo,
            variables: {
              addSolicitudPrestamoInput2: {
                tipoSolicitud: tipo,
                estadoSolicitud: estado,
                fechaSolicitud: fechaActual,
                usuario: usuarioId,
                prestamos: [],
              },
            },
          }),
          success: function (response) {
            let ahora = new Date();
            let tiempo = ahora.getTime();
            let expireTime = tiempo + 900000;
            ahora.setTime(expireTime);
            let solicitud = response.data.addSolicitudPrestamo;
            idSolicitudGeneral = solicitud.id
          },
        });
      }

      let listaIDPrestamos = [];
      function mapToArrayElements(valor, key, map){
        let listaPrestamos = valor
        for (prestamo of listaPrestamos){
          listaIDPrestamos.push(prestamo.id)
        }
      }
      function updSolicitudPrestamo(mapPrestamos) {
        let idSolicitud = idSolicitudGeneral
        
        listaIDPrestamos = []
        mapPrestamos.forEach(mapToArrayElements)
        let fechaActual = Date.now();
        let tipo = "Sala";
        let estado = 0;
        let usuarioId = usuarioIdGeneral;
        let queryupdSolicitud = `
        mutation UpdSolicitudPrestamo($updSolicitudPrestamoId: ID!, $updSolicitudPrestamoInput2: SolicitudPrestamoInput) {
          updSolicitudPrestamo(id: $updSolicitudPrestamoId, input: $updSolicitudPrestamoInput2) {
            statusCode
            body
            errorCode
            descriptionError
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryupdSolicitud,
            variables: {
              updSolicitudPrestamoId: idSolicitud,
              updSolicitudPrestamoInput2: {
                tipoSolicitud: tipo,
                estadoSolicitud: estado,
                fechaSolicitud: fechaActual,
                usuario: usuarioId,
                prestamos: listaIDPrestamos,
              },
            },
          }),
          success: function (response) {
            console.log("UpdSolicitudCompletado");
          },
        });
      }

      let cantEjemplaresDisponible = 0;
      let cantEjemplaresSala = 0;
      // Obtener los ejemplares y crear el inner html
      function getEjemplares(documentoId, estado, estadoTexto) {
        let queryCantEjemplares = `
        query Query($documentoId: ID!, $estado: Int) {
          getCantEjemplaresByDocumentoAndEstado(documentoId: $documentoId, estado: $estado)
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryCantEjemplares,
            variables: {
              documentoId: documentoId,
              estado: estado,
            },
          }),
          success: function (response) {
            let cant = response.data.getCantEjemplaresByDocumentoAndEstado;
            if (estado == 3) {
              cantEjemplaresDisponible =
                response.data.getCantEjemplaresByDocumentoAndEstado;
              let strInputGroup = `
              <button class="btn btn-outline-secondary btn-number-${documentoId}" type="button" id="${documentoId}-button-minus" documentId="${documentoId}" data-type="minus">-</button>
              <input readonly="readonly" type="text" class="form-control input-number" value="0" min="0" max="${cantEjemplaresDisponible}" id="${documentoId}-input">
              <button class="btn btn-outline-secondary btn-number-${documentoId}" type="button" id="${documentoId}-button-plus" documentId="${documentoId}" data-type="plus">+</button>
              `;
              document.getElementById(`${documentoId}-inputGroup`).innerHTML =
                strInputGroup;

              $(`.btn-number-${documentoId}`).click(function () {
                let tipo = $(this).attr("data-type");
                let documentId = $(this).attr("documentId");
                let input = $(`#${documentoId}-input`);
                let currentValue = parseInt(input.val());
                if (!isNaN(currentValue)) {
                  if (tipo == "minus") {
                    if (currentValue > input.attr("min")) {
                      input.val(currentValue - 1).change();
                    }
                    if (parseInt(input.val()) == input.attr("min")) {
                      $(this).attr("disabled", false);
                    }
                  } else {
                    if (currentValue < input.attr("max")) {
                      input.val(currentValue + 1).change();
                    }
                    if (parseInt(input.val()) == input.attr("max")) {
                      $(this).attr("disabled", false);
                    }
                  }
                } else {
                  input.val(0);
                }
              });
            }
            if (estado == 2) {
              cantEjemplaresSala =
                response.data.getCantEjemplaresByDocumentoAndEstado;
            }

            let elementoCantEjemplares = document.getElementById(
              `${documentoId}.${estadoTexto}`
            );
            elementoCantEjemplares.innerHTML = `${estadoTexto}: ${cant}`;
            elementoCantEjemplares.setAttribute("valor", cant);
          },
        });
      }

      // Definir la card para cada elemento del catalogo, obteniendo los ejemplares y preparando la informacion
      let listCardDocumentos = [];
      function cardDocumentos(item) {
        let listCategoriaDocumentosId = [];
        let listCategoriaDocumentosNombre = [];

        for (categoria of item.categoriaDocumento) {
          listCategoriaDocumentosId.push(categoria.id);
          listCategoriaDocumentosNombre.push(categoria.categoria);
        }

        getEjemplares(item.id, 3, "Disponible");
        getEjemplares(item.id, 2, "En Sala");

        let stringCard = `
        <div class="col-12 col-sm-12 col-md-6 col-lg-4 col-xl-3 col-xxl-3 mb-4">
          <div class="card border-secondary mb-3" id=${
            item.id
          } categoria=${listCategoriaDocumentosId} tipoDocumento=${
          item.tipoDocumento.id
        }>
              <div class="card-body" id=${item.id}>
                <h4 class="card-title truncate-text fw-bold">${item.titulo}</h4>
                <p class="card-text" id="card-text" autor="${
                  item.autor
                }" tipoDocumento="${item.tipoDocumento.tipo}">${item.autor}, ${
          item.anioSalida
        }, ${item.editorial}, ${item.tipoDocumento.tipo},</p>
                <div class="d-flex justify-content-center">
                  <button class="btn btn-outline-secondary collapse-button" type="button" data-bs-toggle="collapse" data-bs-target="#${
                    item.id
                  }-collapse">
                    Ver más información
                  </button>
                </div>
                <div class="collapse collapse-card" id="${item.id}-collapse">
                  <div class="container my-3">
                    <p class="card-text my-1">${item.edicion}a Edición</p>
                    <p class="card-text my-1">Categorias: ${listCategoriaDocumentosNombre.toString()}</p>
                    <p class="card-text my-1" id="${
                      item.id
                    }.Disponible">Disponible: </p>
                    <p class="card-text my-1" id="${item.id}.En Sala">Sala: </p>
                    <div class="d-flex justify-content-evenly buttonAndCant">
                      <div class="input-group my-1" id="${item.id}-inputGroup">
                                            
                      </div>
                    </div>
                    
                  </div>
                </div>
              </div>
          </div>
        </div>
        `;
        listCardDocumentos.push(stringCard);
      }

      // Cargar documentos inicial
      async function cargarDocumentos() {
        let queryDocumentos = `
        query GetNDocumentos($numero: Int) {
          getNDocumentos(numero: $numero) {
            id
            titulo
            autor
            editorial
            anioSalida
            edicion
            codigo
            tipoDocumento {
              id
              tipo
            }
            categoriaDocumento {
              id
              categoria
            }
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryDocumentos,
            variables: {
              numero: 100,
            },
          }),

          success: function (response) {
            response.data.getNDocumentos.forEach(cardDocumentos);
            document.getElementById("catalogContainer").innerHTML =
              listCardDocumentos.join("");
            console.log("card agregadas");
            aplicarCambiosCard();
            response.data.getNDocumentos.forEach(optionDocumentos);
            document.getElementById("ModalDocumentoEjemplar").innerHTML =
              optionFormSelectDocumento.join("");


            $('.collapse-card').on('shown.bs.collapse', function () {
                let cardBody = $(this).parent()
                let title = cardBody.children("h4")
                title.removeClass("truncate-text")
            });   
            $('.collapse-card').on('hidden.bs.collapse', function () {
                let cardBody = $(this).parent()
                let title = cardBody.children("h4")
                
                title.addClass("truncate-text")
            });

          },
        });
      }
      // Llamar todas las cosas
      function cargarTipoCategoriasDocumentosAndCookie() {
        cargarTipo();
        cargarCategoria();
        cargarDocumentos();
        checkCookieExistence("tipo");
        revisarUsuarioYSolicitud()
      }

      // La funcion para el query con los filtros
      function getDocumentosByTituloAndAutorAndTipoAndCategoria() {
        listCardDocumentos = [];
        let title = document.getElementById("searchBarTitle").value;
        let aut = document.getElementById("searchBarAuthor").value;
        let tipo = document.getElementById("formSelectTipo").value;
        let categoria = document.getElementById("formSelectCategoria").value;
        if (categoria == "") {
          categoria = null;
        }
        if (tipo == ""){
          tipo = null
        }
        let queryDocumentos = `
        query GetDocumentosByTituloAndAutorAndTipoAndCategoria($titulo: String, $autor: String, $tipoId: ID, $categoriaId: ID) {
          getDocumentosByTituloAndAutorAndTipoAndCategoria(titulo: $titulo, autor: $autor, tipoId: $tipoId, categoriaId: $categoriaId) {
            id
            titulo
            autor
            editorial
            anioSalida
            edicion
            codigo
            tipoDocumento {
              id
              tipo
            }
            categoriaDocumento {
              id
              categoria
            }
          }
        }
        `;
      $.ajax({
        type: "POST",
        url: "http://localhost:8092/graphql",
        contentType: "application/json",
        timeout: 15000,
        data: JSON.stringify({
          query: queryDocumentos,
          variables: {
            titulo: title,
            autor: aut,
            tipoId: tipo,
            categoriaId: categoria,
          },
        }),
        success: function (response) {
          console.log(response)
          response.data.getDocumentosByTituloAndAutorAndTipoAndCategoria.forEach(
            cardDocumentos
          );
          document.getElementById("catalogContainer").innerHTML =
            listCardDocumentos.join("");
          console.log("card agregadas");
          aplicarCambiosCard();
        },    
      });
    }
      function agregarEjemplar() {
        let codigo = document.getElementById("ModalCodigoEjemplar").value;
        let piso = document.getElementById("piso-input-group").value
        let fila = document.getElementById("fila-input-group").value
        let estante = document.getElementById("estante-input-group").value
        let ubicacion = `Piso ${piso} Fila ${fila} Estante ${estante}`
        let idDocumento = document.getElementById(
          "ModalDocumentoEjemplar"
        ).value;
        console.log(codigo, ubicacion, idDocumento);
        let querySignIn = `
        mutation AddEjemplar($input: EjemplarInput) {
          addEjemplar(input: $input) {
            body
            descriptionError
            errorCode
            statusCode
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: querySignIn,
            variables: {
              input: {
                codigo: codigo,
                documento: idDocumento,
                estado: 3,
                estadoTexto: "Disponible",
                ubicacion: ubicacion,
              },
            },
          }),
          success: function (response) {
            console.log("Response:", response);
            let mensajeDiv = document.getElementById("mensajeAddEjemplar");
            mensajeDiv.style.display = 'block'
            if (idDocumento == ""){
              mensajeDiv.innerHTML =
                '<div class="alert alert-danger">No ha sido posible agregar el ejemplar.</div>';
            }
            else{
              mensajeDiv.innerHTML =
                '<div class="alert alert-success">Ejemplar Agregado con éxito.</div>';
            }
            
            setTimeout(function () {
              mensajeDiv.style.display = "none"; 
            }, 2000);
          },
          error: function (error) {
            console.error("Error:", error);
          },
        });
      }

      function eliminarDocumento() {
        let codigo = document.getElementById("ModalCodigoEliminar").value;
        console.log(codigo);
        let querySignIn = `
        mutation DelDocumento($delDocumentoId: ID!) {
          delDocumento(id: $delDocumentoId) {
            body
            descriptionError
            errorCode
            statusCode
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: querySignIn,
            variables: {
              delDocumentoId: codigo,
            },
          }),
          success: function (response) {
            console.log("Response:", response);
          },
          error: function (error) {
            console.error("Error:", error);
          },
        });
      }

      function eliminarEjemplar() {
        let codigo = document.getElementById("ModalejemplarCode").value;
        console.log(codigo);
        let querySignIn = `
        mutation DelEjemplar($delEjemplarId: ID!) {
          delEjemplar(id: $delEjemplarId) {
            statusCode
            body
            errorCode
            descriptionError
          }
        }
        `;
        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: querySignIn,
            variables: {
              delEjemplarId: codigo,
            },
          }),
          success: function (response) {
            console.log("hola:");
          },
          error: function (error) {
            console.error("chao:");
          },
        });

      }
    
    
      function completeInputAgregarEjemplar(){
        let select = document.getElementById("ModalDocumentoEjemplar")
        let indiceSeleccionado = select.selectedIndex
        let elementoSeleccionado = select.options[indiceSeleccionado]
        let tipoSeleccionado = elementoSeleccionado.getAttribute("tipo")
        let indexTipo = tiposDocumentos.indexOf(tipoSeleccionado)
        indiceSeleccionado = `${indiceSeleccionado}`
        if (indiceSeleccionado.length == 1){
          indiceSeleccionado = `0${indiceSeleccionado}`
        }
        let str = `${indexTipo+1}-${indiceSeleccionado}-`

        let input = document.getElementById("ModalCodigoEjemplar")
        input.value = str

      }
    
    
      async function revisarUsuarioYSolicitud(){
        let tipoUsuario = document.cookie
        .split("; ")
        .find((row) => row.startsWith(`tipo=`))
        ?.split("=")[1];
        let usuarioId = usuarioIdGeneral;
        let queryGetSolicitudNoActiva = `
        query GetSolicitudPrestamoByUsuarioId($usuarioId: ID!) {
          getSolicitudPrestamoNoActivaByUsuarioId(usuarioID: $usuarioId) {
            id
            tipoSolicitud
            estadoSolicitud
            fechaSolicitud
            usuario {
              id
              rut
              nombres
              apellidos
              direccion
              telefono
              activo
              codigo
              correo
              password
              tipoUsuario
              fechaSancion
            }
            prestamos {
              id
              tipoPrestamo
              fechaPrestamo
              fechaDevolucion
              fechaDevolucionReal
            }
          }
        }
        `

        $.ajax({
          type: "POST",
          url: "http://localhost:8092/graphql",
          contentType: "application/json",
          timeout: 15000,
          data: JSON.stringify({
            query: queryGetSolicitudNoActiva,
            variables: {
              usuarioId: usuarioId,
            },
          }),
          success: function (response) {
            console.log(response)
            let solicitud = response.data.getSolicitudPrestamoNoActivaByUsuarioId
            if (solicitud == null){
              if(tipoUsuario == 0){
                crearSolicitudInicial()
              }
            }
            else {
              if(tipoUsuario == 0){
                let usuario = solicitud.usuario
                checkUsuarioEstado(usuario)
                idSolicitudGeneral = solicitud.id
              }
            } 
          }
        });
      }

      function checkUsuarioEstado(usuario){

        let actual = new Date(Date.now())
        // Usuario no activo
        if(!usuario.activo){
          return
        }
        // Sancionado
        if(usuario.fechaSancion != null && usuario.fechaSancion > actual){
          isPenalizado = true
          return
        }

      }

    </script>
    <style>

      i{
        font-size: 3vh;
      }

      .enlarge-modal {
        min-width: 1600px;
        width: 900px;
      }
      .hero-section {
        background-color: #908d7e;
        margin-bottom: -1%;
      }

      .alignVertical {
        position:relative;
        height: 50%;
        transform:translateY(+10%);
      }

      h1 {
        font-family: "Noto Sans", sans-serif;
        font-size: 2rem;
        font-weight: 600;
        font-size: 400%;
        padding: 4rem 0
      }

      .letra-main {
        font-family: "Noto Sans", sans-serif;
      }

      .features-section {
        padding: 4rem 0;
      }
      .display-4 {
        font-size: 1000%;
        font-family: "Noto Sans", sans-serif;
      }
      .navbar {
        color: white;
      }

      /* Clase del icono de la pagina */
      .navbar-brand {
        margin: 0px;
      }

      .navbar-toggler-icon {
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3E%3Cpath stroke='white' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3E%3C/svg%3E") !important;
      }

      .navbar-toggler {
        border-color: white; 
      }
      .nav-link {
        align-items: center;
        font-family: "Noto Sans", sans-serif;
        align-content: center;
        font-weight: 500;
        font-size: 1.7vh;
        text-align: end;
        color: #efeae4;
      }
      .card {
        transition: transform 0.2s, box-shadow 0.2s;
        background-color: #efeae4;
        color: #000000;
      }
      .card:hover {
        transform: scale(1.03);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }

      body {
        font-family: "Noto Sans", sans-serif;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        background-color: #c5c3b8;
      }

      .container {
        flex: 1;
      }
      .cat-button {
        width: 200px;
        text-align: center;
        display: inline-block;
      }

      .bg-custom {
        background-color: #efeae4;
      }
      
      .dropdown-menu {
        min-width: 300px;
      }

      .dropdown-check {
        color: #ec1010;
      }
      .color-container {
        background-color: #908d7e; /* ffd500 */
        padding: 4rem 0;
      }

      footer {
        text-align: left;
      }

      .footer-link {
        color: inherit;
        text-decoration: none;
        cursor: pointer;
      }

      .footer-link:hover {
        text-decoration: underline;
        color: inherit;
      }

      .btn-custom-width {
        width: auto;
        min-width: 400px; /* Ajusta según el tamaño que desees para que no se estiren */
        padding: 0.5rem 1rem; /* Espaciado interno para darle un aspecto más compacto */
      }

      .scrollable-menu {
        height: auto;
        max-height: 200px;
        overflow-x: hidden;
      }

      .truncate-text {
        white-space: nowrap; /* Evita el salto de línea */
        overflow: hidden;    /* Oculta el contenido excedente */
        text-overflow: ellipsis; /* Agrega los puntos suspensivos */
      }

    </style>
  </head>
  <body onload="cargarTipoCategoriasDocumentosAndCookie()">
    <nav class="navbar navbar-expand-lg bg-dark navbar-light">
      <div class="container">
        <a class="navbar-brand" href="/Pages/index.html">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="32"
            height="32"
            fill="white"
            class="bi bi-book"
            viewBox="0 0 16 16"
          >
            <path
              d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"
            />
          </svg>
        </a>
        <!-- Botones del navbar-->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="catalogo.html">Catalogo</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#servicios">Servicios</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="ContactoMas.html">Contacto</a>
            </li>
            <!-- "d.none" para oculta como "nav-item d-none"-->
            <li class="nav-item">
              <a class="nav-link d-none" href="/Pages/Admin/PanelAdmin.html" id="NavbarAdmin">Admin</a>
            </li>

            <li class="nav-item">
              <a
                class="nav-link d-none"
                href="/Pages/Bibliotecario/panelbibliotecario.html" id="navbarBibliotecario"
                >Bibliotecario</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="..//User/solicitudDePrestamo.html"
                ><i class="fa-solid fa-cart-shopping d-none" id="carritoCompras"></i
              ></a>
            </li>
          </ul>
        </div>

      </div>

    </div>
  </nav>
    <div class="hero-section">
      <div class="container col-md-8 color-container">
        <h1 class="text-center">Catálogo de Productos</h1>

        <!-- Barra de búsqueda y filtros -->
        <div class="row g-3 mb-4">
          <div class="col-md-6 search-bar">
            <input
              type="text"
              id="searchBarTitle"
              class="form-control bg-custom"
              placeholder="Buscar por Título..."
              value=""
              onchange="getDocumentosByTituloAndAutorAndTipoAndCategoria()"
            />
          </div>
          <div class="col-md-6 search-bar">
            <input
              type="text"
              id="searchBarAuthor"
              class="form-control bg-custom"
              placeholder="Buscar por Autor..."
              value=""
              onchange="getDocumentosByTituloAndAutorAndTipoAndCategoria()"
            />
          </div>
        </div>
        <div class="row g-3 mb-5">
          <div class="col-md-6">
            <select
              id="formSelectTipo"
              class="form-select bg-custom"
              onchange="getDocumentosByTituloAndAutorAndTipoAndCategoria()"
            ></select>
          </div>
          <div class="col-md-6">
            <select
              id="formSelectCategoria"
              class="form-select bg-custom"
              onchange="getDocumentosByTituloAndAutorAndTipoAndCategoria()"
            ></select>
          </div>
        </div>
        <div class="container" id="contaniner-bb-buttons"></div>
      </div>
    </div>

    <div class="container my-5">
      <!-- Contenedor de tarjetas -->
      <div class="row" id="catalogContainer">
        <!-- Ejemplo de tarjeta -->
      </div>
    </div>
    <!-- Modal Agregar Documentos -->
    <div
      class="modal fade"
      id="Agregardoc"
      tabindex="-1"
      aria-labelledby="exampleModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">
              Agregar Documento
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <!-- Titulo -->
              <div class="mb-3">
                <label for="ModalTitulo" class="form-label">Título</label>
                <input type="text" class="form-control" id="ModalTitulo" />
              </div>

              <!-- Autor -->
              <div class="mb-3">
                <label for="ModalAutor" class="form-label">Autor</label>
                <input type="text" class="form-control" id="ModalAutor" />
              </div>

              <div class="row">
                <!-- Año Salida -->
                <div class="col-md-4 mb-3">
                  <label for="ModalAnioSalida" class="form-label"
                    >Año Salida</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="ModalAnioSalida"
                  />
                </div>
                <!-- Edición -->
                <div class="col-md-4 mb-3">
                  <label for="ModalEdicion" class="form-label">Edición</label>
                  <input type="text" class="form-control" id="ModalEdicion" />
                </div>
                <!-- Editorial -->
                <div class="col-md-4 mb-3">
                  <label for="ModalEditorial" class="form-label"
                    >Editorial</label
                  >
                  <input type="text" class="form-control" id="ModalEditorial" />
                </div>
              </div>
              <!-- Código -->
              <div class="mb-3">
                <label for="ModalCodigo" class="form-label">Código</label>
                <input
                  type="text"
                  class="form-control"
                  id="ModalCodigo"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="row">
                <!-- Categoría (Multiselect jerárquico) -->
                <div class="col-md-6 mb-3">
                  <label for="multiSelect" class="form-label">Categoría</label>
                  <div class="dropdown">
                    <button
                      class="btn btn-outline-secondary dropdown-toggle cat-button"
                      type="button"
                      id="multiSelectDropdown"
                      data-bs-toggle="dropdown"
                      aria-expanded="false"
                    >
                      Seleccionar
                    </button>
                    <div
                      class="dropdown-menu p-2 scrollable-menu"
                      aria-labelledby="multiSelectDropdown"
                      id="TipCategoriaModal"
                    ></div>
                  </div>
                  <div class="mt-2">
                    <span id="selectedCategories" class="dropdown-check"
                      >No se han seleccionado categorías.</span
                    >
                  </div>
                </div>
                <!-- Tipo Documento -->
                <div class="col-md-6 mb-3">
                  <label for="ModalformSelectTipo" class="form-label"
                    >Documento</label
                  >
                  <select id="ModalformSelectTipo" class="form-select"></select>
                </div>
              </div>
            </form>
            <div id="mensajeAddDocumento"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="AddDocumento()"
            >
              Agregar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Agregar Ejemplares -->

    <div class="modal fade" id="ModalAgregarEjemplares" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Agregar Ejemplares</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form action="">
              <div class="mb-3">
                <label for="ModalCodigoEjemplar" class="form-label"
                  >Codigo Ejemplar</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="ModalCodigoEjemplar"
                  aria-describedby="emailHelp"
                />
              </div>
              <div class="mb-3">
                <label for="ModalDocumentoEjemplar" class="form-label"
                  >Documento</label
                >
                <select
                  class="form-select"
                  id="ModalDocumentoEjemplar"
                  onchange="completeInputAgregarEjemplar()"
                ></select>
              </div>
              <div class="mb-3">
                <label for="ModalUbicaionEjemplar" class="form-label"
                  >Ubicacion</label
                >
                <div class="input-group">
                  <span class="input-group-text">Piso</span>
                  <select class="form-select" aria-label="Default select example" id="piso-input-group">
                    <option value="1">1</option>
                    <option value="2">2</option>
                  </select>
                  <span class="input-group-text">Fila</span>
                  <input type="text" aria-label="Last name" class="form-control" id="fila-input-group">
                  <span class="input-group-text">Estante</span>
                  <input type="text" aria-label="Last name" class="form-control" id="estante-input-group">
                </div>
              </div>
            </form>
            <div id="mensajeAddEjemplar"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              onclick="agregarEjemplar()"
            >
              Agregar
            </button>

          </div>
        </div>
      </div>
    </div>

    <!-- Modal Eliminar Documento elimina por la id del ejemplar -->

    <!-- Primer Modal -->
    <div class="modal fade" id="ModalEliminarDocumento" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Eliminar Documento</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="ModalCodigoEliminar" class="form-label"
                  >Código Documento</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="ModalCodigoEliminar"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Botón que muestra el segundo modal -->
            <button
              type="button"
              class="btn btn-primary"
              data-bs-target="#ModalConfirmarEliminar"
              data-bs-toggle="modal"
              data-bs-dismiss="modal"
            >
              Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Segundo Modal (Confirmación) -->
    <div class="modal fade" id="ModalConfirmarEliminar" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirmación</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>¿Estás seguro de que quieres eliminar este documento?</p>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="eliminarDocumento()"
            >
              Confirmar
            </button>
          </div>
        </div>
      </div>
    </div>
    <!--modal de eliminar ejemplar-->
    <!-- Primer Modal -->
    <div class="modal fade" id="DelEjemplares" tabindex="-1">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Eliminar Ejemplar</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <div class="mb-3">
                <label for="ModalejemplarCode" class="form-label"
                  >Id del Ejemplar</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="ModalejemplarCode"
                />
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <!-- Botón que muestra el segundo modal -->
            <button
              type="button"
              class="btn btn-primary"
              data-bs-target="#ModalConfirmarEjemplar"
              data-bs-toggle="modal"
              data-bs-dismiss="modal"
            >
              Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Segundo Modal (Confirmación) -->
    <div class="modal fade" id="ModalConfirmarEjemplar" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirmación</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <p>¿Estás seguro de que quieres eliminar este id de ejemplar?</p>
          </div>
          <div id="mensajeEliminarEjemplar"></div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-danger"
              onclick="eliminarEjemplar()"
            >
              Confirmar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer begins here remember to keep your house tidy an you too-->

    <footer class="bg-dark text-light py-4">
      <div class="container">
        <div class="row">
          <div class="col-md-3 mb-3">
            <h5>Muni Book</h5>
            <ul class="list-unstyled">
              <li>Tu libreria de confianza</li>
              <li>Siguenos en redes!</li>
            </ul>
          </div>
          <div class="col-md-3 mb-3">
            <h5>Explorar</h5>
            <ul class="list-unstyled">
              <li>
                <a class="footer-link" href="catalogo.html"> Catalogo </a>
              </li>
              <a onclick="loginButton()">Inicia Sesion</a>
            </ul>
          </div>
          <div class="col-md-3 mb-3">
            <h5>Recursos</h5>
            <ul class="list-unstyled">
              <li>
                <a class="footer-link" href="#">Sobre nosotros</a>
              </li>
              <li>
                <a class="footer-link" href="#">Contactanos</a>
              </li>
              <li>
                <a class="footer-link" href="#">Atencion al cliente</a>
              </li>
            </ul>
          </div>
          <div class="col-md-3 mb-3">
            <h5>Siguenos</h5>
            <div class="d-flex">
              <a href="#" class="text-light me-2">
                <i class="fa-brands fa-instagram"></i>
              </a>
              <a href="#" class="text-light me-2">
                <i class="fa-brands fa-facebook"></i>
              </a>
              <a href="#" class="text-light me-2">
                <i class="fa-brands fa-x-twitter"></i>
              </a>
              <a href="#" class="text-light">
                <i class="fa-brands fa-youtube"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </body>
</html>

